name: "[Datana:Socket:V2] Change of temperature"
###name: "Change of temperature"

run_every:
  seconds: 1

realert:
  minutes: 10

index: datana-smart-dev-logs-*
# A rule that matches if num_events number of events occur within a timeframe
num_events: 1

###################################
# а изменение - мониторить значения температуры
type: change

# (Required, change specific)
# The field to look for changes in
compare_key: "data.transportMessage.content.sensors.data"

timeframe:
  hours: 1

buffer_time:
  seconds: 10

# https://github.com/Yelp/elastalert/issues/1010
timestamp_field: "@timestamp"
#### error elk --- ### timestamp_type: custom
#### error elk --- ### timestamp_format: "%Y-%m-%d %H:%M:%S.%f%z"
### 2020-10-28 14:43:46.543913+00:00 format elastelart
##timestamp_type: unix
timestamp_type: iso

# (Required, change specific)
# Ignore documents without the compare_key (country_name) field
ignore_null: false

# (Required, change specific)
# The change must occur in two documents with the same query_key
query_key: component.keyword

doc_type: _doc

filter:
  - query:
      query_string:
        query: "data.transportMessage.content.sensors.data>0"

alert:
  - "telegram"

use_local_time: True

telegram_bot_token: 1171367749:AAFgyOW0LGRLl9NHo9TkZIGNUdd6cFKYGqo

telegram_room_id: "@DatanaReleaseEvent"

alert_text: "Версия 2 (пока не готово). Server is UP. Время (формат ISO без TimeZone) = {0}, Модуль (Тип приложения) = {1}"
alert_text_args: ["@timestamp", "component"]
alert_text_type: alert_text_only


