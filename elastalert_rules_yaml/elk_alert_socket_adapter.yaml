es_host: datana-logs.datana.ru
es_port: 9200
name: Socket Adapter Of Datana Smart
type: frequency
index: datana-smart-dev-logs-*
num_events: 10
timeframe:
  hours: 1
aggregation_key: "@timestamp"
aggregation:
  seconds: 2
filter:
  - query:
      query_string:
        ## simple kostya filter for example with contains '112' chars
        ###query: "data.message : *112*"
        ###query: "level.keyword : WARN"
        ###query: "level.keyword : INFO"
        ### ok message#### query: "data.requestTransportInfoId : ef171ac4-d89d-4ed5-9bb0-bf0f57d5bb03"
        ######################query: "@timestamp gte now-1d/d AND @timestamp lte now/d"
        ## query : "_exists_: @timestamp >= 'now-1s/s'"
        ##query: "logger_name: ru.datana.integrationadapter.socket.integration.connector.S7Api"
        query: "@timestamp >=: 'now-1s'"
### ok3 ### logger_name: ru.datana.integrationadapter.socket.integration.connector.S7Api AND message: *Получена data из S7Connector и создан МultiSensorModel объект с sensorTemperatureUUID\: 8e630dd0-5796-45e0-8d85-8a14c5d872dd*
      ### warn-ok3 ### logger_name: ru.datana.integrationadapter.socket.integration.connector.S7Api AND message: *Получена data из S7Connector и создан МultiSensorModel объект с sensorTemperatureUUID\: 8e630dd0-5796-45e0-8d85-8a14c5d872dd* AND @timestamp >= "now-1s/s"
alert:
  - "telegram"

## телеграм для релизов датаны (для примера взято)
##      def final constTelegramReleaseURL = "https://api.telegram.org/bot1171367749:AAFgyOW0LGRLl9NHo9TkZIGNUdd6cFKYGqo/sendMessage?chat_id=-1001451379215&parse_mode=HTML"

telegram_bot_token: 1171367749:AAFgyOW0LGRLl9NHo9TkZIGNUdd6cFKYGqo

telegram_room_id: "@DatanaReleaseEvent"

alert_text: "from elastalert - {0}, {1}, {2}"
alert_text_args: ["type", "username2", "timestamp"]
alert_text_type: alert_text_only